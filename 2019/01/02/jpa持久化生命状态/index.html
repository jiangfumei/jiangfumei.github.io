<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/site32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://jiangfumei.github.io').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.6.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="å¼€ç¯‡ æŸæ—¥å†™ç¨‹åºæ—¶ï¼Œä½¿ç”¨jpaæ“ä½œæ•°æ®åº“ï¼Œå½“æˆ‘ä½¿ç”¨findAllï¼ˆï¼‰æ–¹æ³•æŸ¥å¤„ä¸€ä¸ªListçš„å¯¹è±¡åï¼Œç»™å¯¹è¿™ä¸ªlistçš„å®ä½“è¿›è¡Œäº†ä¸€äº›æ“ä½œï¼Œå¹¶æ²¡æœ‰è°ƒç”¨update æˆ–è€… saveOrUpdateæ–¹æ³•ï¼Œæ›´æ”¹åçš„æ•°æ®å´ç¥å¥‡çš„ä¿å­˜åˆ°æ•°æ®åº“é‡Œé¢å»äº†ğŸ˜•ğŸ˜•ğŸ˜•æˆ‘ä¹Ÿåœ¨serviceå±‚æ·»åŠ äº‹ç‰©äº†å•Šã€‚åé¢æ‰¾äº†èµ„æ–™æ‰å‘ç°æ˜¯jpaæ˜¯å¯¹hibernateçš„å°è£…ï¼Œåº•å±‚æ˜¯hibernateï¼Œè¿™æ˜¯hibernateçš„æŒä¹…çŠ¶æ€æ">
<meta property="og:type" content="article">
<meta property="og:title" content="JPA hibernateçš„æŒä¹…åŒ–ç”Ÿå‘½çŠ¶æ€">
<meta property="og:url" content="https://jiangfumei.github.io/2019/01/02/jpa%E6%8C%81%E4%B9%85%E5%8C%96%E7%94%9F%E5%91%BD%E7%8A%B6%E6%80%81/index.html">
<meta property="og:site_name" content="Struggler&#39;s Blog">
<meta property="og:description" content="å¼€ç¯‡ æŸæ—¥å†™ç¨‹åºæ—¶ï¼Œä½¿ç”¨jpaæ“ä½œæ•°æ®åº“ï¼Œå½“æˆ‘ä½¿ç”¨findAllï¼ˆï¼‰æ–¹æ³•æŸ¥å¤„ä¸€ä¸ªListçš„å¯¹è±¡åï¼Œç»™å¯¹è¿™ä¸ªlistçš„å®ä½“è¿›è¡Œäº†ä¸€äº›æ“ä½œï¼Œå¹¶æ²¡æœ‰è°ƒç”¨update æˆ–è€… saveOrUpdateæ–¹æ³•ï¼Œæ›´æ”¹åçš„æ•°æ®å´ç¥å¥‡çš„ä¿å­˜åˆ°æ•°æ®åº“é‡Œé¢å»äº†ğŸ˜•ğŸ˜•ğŸ˜•æˆ‘ä¹Ÿåœ¨serviceå±‚æ·»åŠ äº‹ç‰©äº†å•Šã€‚åé¢æ‰¾äº†èµ„æ–™æ‰å‘ç°æ˜¯jpaæ˜¯å¯¹hibernateçš„å°è£…ï¼Œåº•å±‚æ˜¯hibernateï¼Œè¿™æ˜¯hibernateçš„æŒä¹…çŠ¶æ€æ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://jiangfumei.github.io/images/hibernate.jpg">
<meta property="article:published_time" content="2019-01-02T02:46:19.000Z">
<meta property="article:modified_time" content="2020-04-09T06:14:42.343Z">
<meta property="article:author" content="jiangfumei">
<meta property="article:tag" content="SpringBoot">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jiangfumei.github.io/images/hibernate.jpg">

<link rel="canonical" href="https://jiangfumei.github.io/2019/01/02/jpa%E6%8C%81%E4%B9%85%E5%8C%96%E7%94%9F%E5%91%BD%E7%8A%B6%E6%80%81/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>JPA hibernateçš„æŒä¹…åŒ–ç”Ÿå‘½çŠ¶æ€ | Struggler's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Struggler's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">ä¸ç©è·¬æ­¥,ç„¡ä»¥è‡³åƒé‡Œ | ä¸ç©å°æµ,ç„¡ä»¥æˆæ±Ÿæµ·</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>æ ‡ç­¾<span class="badge">24</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>åˆ†ç±»<span class="badge">20</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>å½’æ¡£<span class="badge">37</span></a>

  </li>
        <li class="menu-item menu-item-comments">

    <a href="/comments/" rel="section"><i class="fa fa-fw fa-comments"></i>comments</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-fw fa-heartbeat"></i>å…¬ç›Š 404</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="æœç´¢..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/jiangfumei" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jiangfumei.github.io/2019/01/02/jpa%E6%8C%81%E4%B9%85%E5%8C%96%E7%94%9F%E5%91%BD%E7%8A%B6%E6%80%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/hade.jpg">
      <meta itemprop="name" content="jiangfumei">
      <meta itemprop="description" content="å­¸ç„¡æ­¢å¢ƒï¼Œæ°£æœ‰æµ©ç„¶">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Struggler's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          JPA hibernateçš„æŒä¹…åŒ–ç”Ÿå‘½çŠ¶æ€<a href="https://github.com/user-name/repo-name/tree/branch-name/subdirectory-name_posts/jpa%E6%8C%81%E4%B9%85%E5%8C%96%E7%94%9F%E5%91%BD%E7%8A%B6%E6%80%81.md" class="post-edit-link" title="ç¼–è¾‘" rel="noopener" target="_blank"><i class="fa fa-pencil"></i></a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-02 10:46:19" itemprop="dateCreated datePublished" datetime="2019-01-02T10:46:19+08:00">2019-01-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-04-09 14:14:42" itemprop="dateModified" datetime="2020-04-09T14:14:42+08:00">2020-04-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SpringBoot/" itemprop="url" rel="index">
                    <span itemprop="name">SpringBoot</span>
                  </a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valineï¼š</span>
    
    <a title="valine" href="/2019/01/02/jpa%E6%8C%81%E4%B9%85%E5%8C%96%E7%94%9F%E5%91%BD%E7%8A%B6%E6%80%81/#comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/01/02/jpa%E6%8C%81%E4%B9%85%E5%8C%96%E7%94%9F%E5%91%BD%E7%8A%B6%E6%80%81/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="å¼€ç¯‡">å¼€ç¯‡</h2>
<p>æŸæ—¥å†™ç¨‹åºæ—¶ï¼Œä½¿ç”¨jpaæ“ä½œæ•°æ®åº“ï¼Œå½“æˆ‘ä½¿ç”¨<code>findAllï¼ˆï¼‰</code>æ–¹æ³•æŸ¥å¤„ä¸€ä¸ªListçš„å¯¹è±¡åï¼Œç»™å¯¹è¿™ä¸ªlistçš„å®ä½“è¿›è¡Œäº†ä¸€äº›æ“ä½œï¼Œå¹¶æ²¡æœ‰è°ƒç”¨<code>update</code> æˆ–è€… <code>saveOrUpdate</code>æ–¹æ³•ï¼Œæ›´æ”¹åçš„æ•°æ®å´ç¥å¥‡çš„ä¿å­˜åˆ°æ•°æ®åº“é‡Œé¢å»äº†ğŸ˜•ğŸ˜•ğŸ˜•æˆ‘ä¹Ÿåœ¨serviceå±‚æ·»åŠ äº‹ç‰©äº†å•Šã€‚åé¢æ‰¾äº†èµ„æ–™æ‰å‘ç°æ˜¯jpaæ˜¯å¯¹hibernateçš„å°è£…ï¼Œåº•å±‚æ˜¯hibernateï¼Œè¿™æ˜¯hibernateçš„æŒä¹…çŠ¶æ€æçš„é¬¼ã€‚</p>
<a id="more"></a>
<h2 id="hibernate-çš„ä¸‰ç§çŠ¶æ€">hibernate çš„ä¸‰ç§çŠ¶æ€</h2>
<ol>
<li><strong>ç¬æ—¶çŠ¶æ€ (Transient)</strong><br>
å½“æˆ‘ä»¬é€šè¿‡Javaçš„newå…³é”®å­—æ¥ç”Ÿæˆä¸€ä¸ªå®ä½“å¯¹è±¡æ—¶ï¼Œè¿™æ—¶è¿™ä¸ªå®ä½“å¯¹è±¡å°±å¤„äºè‡ªç”±çŠ¶æ€ï¼Œå¦‚ä¸‹ï¼š<br>
<code>People people=new People(â€œxsâ€,20);</code><br>
æ­¤æ—¶peopleåªæ˜¯é€šè¿‡JVMè·å¾—äº†ä¸€å—å†…å­˜ç©ºé—´ï¼Œè¿˜å¹¶æ²¡æœ‰é€šè¿‡Sessionå¯¹è±¡çš„save()æ–¹æ³•ä¿å­˜è¿›æ•°æ®åº“ï¼Œå› æ­¤ä¹Ÿå°±è¿˜æ²¡æœ‰çº³å…¥Hibernateçš„ç¼“å­˜ç®¡ç†ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´customerå¯¹è±¡ç°åœ¨è¿˜è‡ªç”±çš„æ¸¸è¡äºHibernateç¼“å­˜ç®¡ç†ä¹‹å¤–ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè‡ªç”±å¯¹è±¡æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯ï¼Œåœ¨æ•°æ®åº“ä¸­ä¸å­˜åœ¨ä¸€æ¡ä¸å®ƒå¯¹åº”çš„è®°å½•ã€‚<br>
ç¬æ—¶å¯¹è±¡ç‰¹ç‚¹ï¼š<br>
<strong>ä¸å’Œ Session å®ä¾‹å…³è”</strong><br>
<strong>åœ¨æ•°æ®åº“ä¸­æ²¡æœ‰å’Œç¬æ—¶å¯¹è±¡å…³è”çš„è®°å½•</strong></li>
<li><strong>æŒä¹…çŠ¶æ€ (Persistent)</strong><br>
æŒä¹…åŒ–å¯¹è±¡å°±æ˜¯å·²ç»è¢«ä¿å­˜è¿›æ•°æ®åº“çš„å®ä½“å¯¹è±¡ï¼Œå¹¶ä¸”è¿™ä¸ªå®ä½“å¯¹è±¡ç°åœ¨è¿˜å¤„äºHibernateçš„ç¼“å­˜ç®¡ç†ä¹‹ä¸­ã€‚è¿™æ˜¯å¯¹è¯¥å®ä½“å¯¹è±¡çš„ä»»ä½•ä¿®æ”¹ï¼Œéƒ½ä¼šåœ¨æ¸…ç†ç¼“å­˜æ—¶åŒæ­¥åˆ°æ•°æ®åº“ä¸­ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">People people=<span class="keyword">new</span> People(â€œxsâ€,<span class="number">20</span>);</span><br><span class="line">tx=session.beginTransaction();</span><br><span class="line">session.save(people);</span><br><span class="line">customer=(Customer)session.load(Customer<span class="class">.<span class="keyword">class</span>,â€1â€)</span>;</span><br><span class="line">customer.setAge(<span class="number">28</span>);</span><br><span class="line">tx.commit();</span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶æˆ‘ä»¬å¹¶æ²¡æœ‰æ˜¾ç¤ºè°ƒç”¨<code>session.update()</code>æ–¹æ³•æ¥ä¿å­˜æ›´æ–°ï¼Œä½†æ˜¯å¯¹å®ä½“å¯¹è±¡çš„ä¿®æ”¹è¿˜æ˜¯ä¼šåŒæ­¥æ›´æ–°åˆ°æ•°æ®åº“ä¸­ï¼Œå› ä¸ºæ­¤æ—¶customerå¯¹è±¡é€šè¿‡saveæ–¹æ³•ä¿å­˜è¿›æ•°æ®åº“åï¼Œå·²ç»æ˜¯æŒä¹…åŒ–å¯¹è±¡äº†ï¼Œç„¶åé€šè¿‡loadæ–¹æ³•å†æ¬¡åŠ è½½å®ƒï¼Œå®ƒä»ç„¶æ˜¯æŒä¹…åŒ–å¯¹è±¡ï¼Œæ‰€ä»¥å®ƒè¿˜å¤„äºHibernateç¼“å­˜çš„ç®¡ç†ä¹‹ä¸­ï¼Œè¿™æ—¶å½“æ‰§è¡Œ<code>tx.commit()</code>æ–¹æ³•æ—¶ï¼Œ<code>Hibernate</code>ä¼šè‡ªåŠ¨æ¸…ç†ç¼“å­˜ï¼Œå¹¶ä¸”è‡ªåŠ¨å°†æŒä¹…åŒ–å¯¹è±¡çš„å±æ€§å˜åŒ–åŒæ­¥åˆ°åˆ°æ•°æ®åº“ä¸­ã€‚<br>
æŒä¹…çš„å®ä¾‹åœ¨æ•°æ®åº“ä¸­æœ‰å¯¹åº”çš„è®°å½•ï¼Œå¹¶æ‹¥æœ‰ä¸€ä¸ªæŒä¹…åŒ–æ ‡è¯† (identifier).æŒä¹…å¯¹è±¡æ€»æ˜¯ä¸ <code>Session</code> å’Œ <code>Transaction</code> ç›¸å…³è”ï¼Œåœ¨ä¸€ä¸ª<code> Session</code> ä¸­ï¼Œå¯¹æŒä¹…å¯¹è±¡çš„æ”¹å˜ä¸ä¼šé©¬ä¸Šå¯¹æ•°æ®åº“è¿›è¡Œå˜æ›´ï¼Œè€Œå¿…é¡»åœ¨<code>Transaction</code>ç»ˆæ­¢ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œ<code> commit()</code> ä¹‹åï¼Œæ‰åœ¨æ•°æ®åº“ä¸­çœŸæ­£è¿è¡Œ SQL è¿›è¡Œå˜æ›´ï¼ŒæŒä¹…å¯¹è±¡çš„çŠ¶æ€æ‰ä¼šä¸æ•°æ®åº“è¿›è¡ŒåŒæ­¥ã€‚åœ¨åŒæ­¥ä¹‹å‰çš„æŒä¹…å¯¹è±¡ç§°ä¸ºè„ (dirty) å¯¹è±¡ã€‚<br>
ç¬æ—¶å¯¹è±¡è½¬ä¸ºæŒä¹…å¯¹è±¡ï¼š<br>
é€šè¿‡ <code>Session</code> çš„ <code>save()</code> å’Œ <code>saveOrUpdate() </code>æ–¹æ³•æŠŠä¸€ä¸ªç¬æ—¶å¯¹è±¡ä¸æ•°æ®åº“ç›¸å…³è”ï¼Œè¿™ä¸ªç¬æ—¶å¯¹è±¡å°±æˆä¸ºæŒä¹…åŒ–å¯¹è±¡ã€‚<br>
ä½¿ç”¨ <code>fine()</code>,<code>get()</code>,<code>load()</code> å’Œ <code>iterater()</code> å¾…æ–¹æ³•æŸ¥è¯¢åˆ°çš„æ•°æ®å¯¹è±¡ï¼Œå°†æˆä¸ºæŒä¹…åŒ–å¯¹è±¡ã€‚<br>
æŒä¹…åŒ–å¯¹è±¡çš„ç‰¹ç‚¹ï¼š<br>
<strong>å’Œ Session å®ä¾‹å…³è”</strong><br>
<strong>åœ¨æ•°æ®åº“ä¸­æœ‰å’ŒæŒä¹…å¯¹è±¡å…³è”çš„è®°å½•</strong><br>
3. <strong>è„±ç®¡çŠ¶æ€ (Detached)</strong><br>
å½“ä¸€ä¸ªæŒä¹…åŒ–å¯¹è±¡ï¼Œè„±ç¦»å¼€Hibernateçš„ç¼“å­˜ç®¡ç†åï¼Œå®ƒå°±å¤„äºæ¸¸ç¦»çŠ¶æ€ï¼Œæ¸¸ç¦»å¯¹è±¡å’Œè‡ªç”±å¯¹è±¡çš„æœ€å¤§åŒºåˆ«åœ¨äºï¼Œæ¸¸ç¦»å¯¹è±¡åœ¨æ•°æ®åº“ä¸­å¯èƒ½è¿˜å­˜åœ¨ä¸€æ¡ä¸å®ƒå¯¹åº”çš„è®°å½•ï¼Œåªæ˜¯ç°åœ¨è¿™ä¸ªæ¸¸ç¦»å¯¹è±¡è„±ç¦»äº†Hibernateçš„ç¼“å­˜ç®¡ç†ï¼Œè€Œè‡ªç”±å¯¹è±¡ä¸ä¼šåœ¨æ•°æ®åº“ä¸­å‡ºç°ä¸å®ƒå¯¹åº”çš„æ•°æ®è®°å½•ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">People people=<span class="keyword">new</span> People(â€œxsâ€,<span class="number">20</span>);</span><br><span class="line">tx=session.beginTransaction();</span><br><span class="line">session.save(people);</span><br><span class="line">people=(People)session.load(People<span class="class">.<span class="keyword">class</span>,â€1â€)</span>;</span><br><span class="line">people.setAge(<span class="number">28</span>);</span><br><span class="line">tx.commit();</span><br><span class="line">session.close();</span><br></pre></td></tr></table></figure>
<p>å½“sessionå…³é—­åï¼Œcustomerå¯¹è±¡å°±ä¸å¤„äºHibernateçš„ç¼“å­˜ç®¡ç†ä¹‹ä¸­äº†ï¼Œä½†æ˜¯æ­¤æ—¶åœ¨æ•°æ®åº“ä¸­è¿˜å­˜åœ¨ä¸€æ¡ä¸customerå¯¹è±¡å¯¹åº”çš„æ•°æ®è®°å½•ï¼Œæ‰€ä»¥æ­¤æ—¶customerå¯¹è±¡å¤„äºæ¸¸ç¦»æ€<br>
ä¸æŒä¹…å¯¹è±¡å…³è”çš„ Session è¢«å…³é—­åï¼Œå¯¹è±¡å°±å˜ä¸ºè„±ç®¡å¯¹è±¡ã€‚å¯¹è„±ç®¡å¯¹è±¡çš„å¼•ç”¨ä¾ç„¶æœ‰æ•ˆï¼Œå¯¹è±¡å¯ç»§ç»­è¢«ä¿®æ”¹ã€‚<br>
è„±ç®¡å¯¹è±¡ç‰¹ç‚¹ï¼š<br>
<strong>æœ¬è´¨ä¸Šå’Œç¬æ—¶å¯¹è±¡ç›¸åŒ</strong><br>
<strong>åªæ˜¯æ¯”ç¬æ—¶å¯¹è±¡å¤šäº†ä¸€ä¸ªæ•°æ®åº“è®°å½•æ ‡è¯†å€¼ id</strong>.<br>
æŒä¹…å¯¹è±¡è½¬ä¸ºè„±ç®¡å¯¹è±¡ï¼š<br>
å½“æ‰§è¡Œ <code>close() </code>æˆ– <code>clear()</code>,<code>evict()</code> ä¹‹åï¼ŒæŒä¹…å¯¹è±¡ä¼šå˜ä¸ºè„±ç®¡å¯¹è±¡ã€‚<br>
ç¬æ—¶å¯¹è±¡è½¬ä¸ºæŒä¹…å¯¹è±¡ï¼š<br>
é€šè¿‡ <code>Session</code> çš„ <code>update()</code>,<code>saveOrUpdate() </code>å’Œ <code>lock()</code> ç­‰æ–¹æ³•ï¼ŒæŠŠè„±ç®¡å¯¹è±¡å˜ä¸ºæŒä¹…å¯¹è±¡ã€‚<br>
<img src="/images/hibernate.jpg" alt=""></p>
<h2 id="JPA-å®ä½“ç”Ÿå‘½å‘¨æœŸæœ‰å››ç§çŠ¶æ€">JPA å®ä½“ç”Ÿå‘½å‘¨æœŸæœ‰å››ç§çŠ¶æ€</h2>
<p><code>New</code>ï¼šç¬æ—¶å¯¹è±¡ï¼Œå°šæœªæœ‰idï¼Œè¿˜æœªå’Œ<code>Persistence Context</code>å»ºç«‹å…³è”çš„å¯¹è±¡ã€‚<br>
<code>Managed</code>ï¼šæŒä¹…åŒ–å—ç®¡å¯¹è±¡ï¼Œæœ‰idå€¼ï¼Œå·²ç»å’Œ<code>Persistence Context</code>å»ºç«‹äº†å…³è”çš„å¯¹è±¡ã€‚<br>
<code>Datached</code>ï¼šæ¸¸ç¦»æ€ç¦»çº¿å¯¹è±¡ï¼Œæœ‰idå€¼ï¼Œä½†æ²¡æœ‰å’Œ<code>Persistence Context</code>å»ºç«‹å…³è”çš„å¯¹è±¡ã€‚<br>
<code>Removed</code>ï¼šåˆ é™¤çš„å¯¹è±¡ï¼Œæœ‰idå€¼ï¼Œå°šä¸”å’Œ<code>Persistence Context</code>æœ‰å…³è”ï¼Œä½†æ˜¯å·²ç»å‡†å¤‡å¥½ä»æ•°æ®åº“ä¸­åˆ é™¤ã€‚<br>
<code>Managed</code>çŠ¶æ€ä¸‹çš„æ•°æ®ä¿å­˜ï¼Œæ›´æ–°ä»¥åŠåˆ é™¤æ•°æ®ä¸‹çš„<code>Removed</code>çŠ¶æ€ï¼Œæ•°æ®éƒ½ä¸ä¼šç«‹å³æ›´æ–°åˆ°æ•°æ®åº“ï¼Œåªæœ‰å½“ä½ äº‹åŠ¡æäº¤æˆ–è€…<code>em.flush()</code>ï¼Œæ‰ä¼šç«‹å³æ›´æ–°åˆ°æ•°æ®åº“ã€‚<br>
<code>Datached</code>çš„çŠ¶æ€ï¼Œå¯ä»¥è°ƒç”¨<code>em.merge()</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šæ ¹æ®å®ä½“ç±»çš„idæ¥æ›´æ–°æ•°æ®åº“æ•°æ®ï¼Œè¿™æ—¶å®ä½“ç±»å˜æˆäº†<code>Managed</code>çŠ¶æ€ã€‚<br>
å››ç§çŠ¶æ€æ€»ç»“ï¼š</p>
<p>çŠ¶æ€å                      ä½œä¸ºjavaå¯¹è±¡å­˜åœ¨                    åœ¨å®ä½“ç®¡ç†å™¨ä¸­å­˜åœ¨                      åœ¨æ•°æ®åº“å­˜åœ¨</p>
<p>New                             yes                                 no                                  no</p>
<p>Managed                         yes                                 yes                                 yes</p>
<p>Detached                        no                                  no                                  no</p>
<p>Removed                         yes                                 yes                                 no</p>
<h2 id="è§£å†³åŠæ³•">è§£å†³åŠæ³•</h2>
<ol>
<li>æ³¨å…¥EntityManager</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PersistenceContext</span></span><br><span class="line">EntityManager entityManager;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>ä¸´æ—¶èµ‹å€¼å,detchå¯¹è±¡</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">entityManager.detach(xxx);</span><br></pre></td></tr></table></figure>
<p>eg:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Video&gt; living = videos.getContent().stream().filter(x-&gt;x.getIsLive()!=<span class="keyword">null</span>).filter(x-&gt;x.getIsLive()==<span class="number">2</span>).filter(x-&gt;x.getLiveTime().compareTo(<span class="keyword">new</span> Date())&gt;<span class="number">0</span>).collect(Collectors.toList());</span><br><span class="line">           living.forEach(e-&gt;&#123;</span><br><span class="line">               e.setHd(<span class="string">""</span>);</span><br><span class="line">               e.setSd(<span class="string">""</span>);</span><br><span class="line">               e.setUltraClear(<span class="string">""</span>);</span><br><span class="line">               entityManager.detach(e);</span><br><span class="line">           &#125;);</span><br></pre></td></tr></table></figure>
<h2 id="detach-æ–¹æ³•">detach()æ–¹æ³•</h2>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Method</span><br><span class="line">javax.persistence.EntityManager</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">detach</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">  Object entity</span></span></span><br><span class="line"><span class="function"><span class="params">)</span></span></span><br></pre></td></tr></table></figure>
<p>Remove the given entity from the persistence context, causing a managed entity to become detached. Unflushed changes made to the entity if any (including removal of the entity), will not be synchronized to the database. Entities which previously referenced the detached entity will continue to reference it.<br>
Parameters:<br>
entity - entity instance<br>
Throws:<br>
IllegalArgumentException - if the instance is not an entity<br>
Since:<br>
JPA 2.0</p>
<p><a href="https://www.cnblogs.com/0201zcr/p/6580192.html" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥</a></p>

    </div>

    
    
    
        <div class="reward-container">
  <div>æ¬£èµæ­¤æ–‡ï¼Ÿæ±‚é¼“åŠ±ï¼Œæ±‚æ”¯æŒï¼</div>
  <button disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    æ‰“èµ
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.png" alt="jiangfumei å¾®ä¿¡æ”¯ä»˜">
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.png" alt="jiangfumei æ”¯ä»˜å®">
        <p>æ”¯ä»˜å®</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>jiangfumei
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://jiangfumei.github.io/2019/01/02/jpa%E6%8C%81%E4%B9%85%E5%8C%96%E7%94%9F%E5%91%BD%E7%8A%B6%E6%80%81/" title="JPA hibernateçš„æŒä¹…åŒ–ç”Ÿå‘½çŠ¶æ€">https://jiangfumei.github.io/2019/01/02/jpaæŒä¹…åŒ–ç”Ÿå‘½çŠ¶æ€/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/SpringBoot/" rel="tag"># SpringBoot</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2018/12/27/nginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/" rel="prev" title="NginxåŸŸåè½¬å‘">
      <i class="fa fa-chevron-left"></i> NginxåŸŸåè½¬å‘
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/01/03/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/" rel="next" title="javaè®¾è®¡æ¨¡å¼">
      javaè®¾è®¡æ¨¡å¼ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#å¼€ç¯‡"><span class="nav-number">1.</span> <span class="nav-text">å¼€ç¯‡</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hibernate-çš„ä¸‰ç§çŠ¶æ€"><span class="nav-number">2.</span> <span class="nav-text">hibernate çš„ä¸‰ç§çŠ¶æ€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JPA-å®ä½“ç”Ÿå‘½å‘¨æœŸæœ‰å››ç§çŠ¶æ€"><span class="nav-number">3.</span> <span class="nav-text">JPA å®ä½“ç”Ÿå‘½å‘¨æœŸæœ‰å››ç§çŠ¶æ€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è§£å†³åŠæ³•"><span class="nav-number">4.</span> <span class="nav-text">è§£å†³åŠæ³•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#detach-æ–¹æ³•"><span class="nav-number">5.</span> <span class="nav-text">detach()æ–¹æ³•</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="jiangfumei"
      src="/images/hade.jpg">
  <p class="site-author-name" itemprop="name">jiangfumei</p>
  <div class="site-description" itemprop="description">å­¸ç„¡æ­¢å¢ƒï¼Œæ°£æœ‰æµ©ç„¶</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">37</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/jiangfumei" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;jiangfumei" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:fumeijiang666@gmail.com" title="E-Mail â†’ mailto:fumeijiang666@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/JFM%C3%B7UP" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;JFMÃ·UP" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://plus.google.com/fumeijiang666" title="Google â†’ https:&#x2F;&#x2F;plus.google.com&#x2F;fumeijiang666" rel="noopener" target="_blank"><i class="fa fa-fw fa-google"></i></a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://waver.me/" title="https:&#x2F;&#x2F;waver.me&#x2F;" rel="noopener" target="_blank">waver</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://ehlxr.me/" title="https:&#x2F;&#x2F;ehlxr.me&#x2F;" rel="noopener" target="_blank">ehlxr</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://blog.didispace.com/" title="http:&#x2F;&#x2F;blog.didispace.com" rel="noopener" target="_blank">ç¨‹åºå‘˜DD</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.fangzhipeng.com/" title="https:&#x2F;&#x2F;www.fangzhipeng.com&#x2F;" rel="noopener" target="_blank">æ–¹å¿—æœ‹</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.ityouknow.com/" title="http:&#x2F;&#x2F;www.ityouknow.com" rel="noopener" target="_blank">çº¯æ´çš„å¾®ç¬‘</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">by jiangfumei</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> å¼ºåŠ›é©±åŠ¨ v4.2.1
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">ä¸»é¢˜ â€“ <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.6.0
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el: '#valine-comments',
      verify: false,
      notify: false,
      appId: '6nnjNCU2uosA1eXry8i8DXaM-gzGzoHsz',
      appKey: 'Cq81iddtrhNg4ooyofXIUUBL',
      placeholder: "Just go go",
      avatar: 'robohash',
      meta: guest,
      pageSize: '10' || 10,
      visitor: false,
      lang: '' || 'zh-cn',
      path: location.pathname,
      recordIP: false,
      serverURLs: ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
